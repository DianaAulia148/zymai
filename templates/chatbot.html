<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>ZYM AI - Chatbot Pelatih Gym</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
body {
    font-family: 'Inter', sans-serif;
    background: #f3f4f6;
}

/* FLOATING WRAPPER */
.chat-floating {
    position: fixed;
    bottom: 24px;
    right: 24px;
    z-index: 9999;
}

/* CHAT CONTAINER */
.chat-container {
    width: 340px;
    height: 460px;
    background: #ffffff;
    border-radius: 20px;
    box-shadow: 0 30px 60px rgba(0,0,0,.35);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* HEADER */
.chat-header {
    background: linear-gradient(135deg, #7c3aed, #c026d3);
    color: white;
    padding: 14px 16px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
}

.chat-header .bot-icon {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: rgba(255,255,255,0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
}

/* CHAT BOX */
.chat-box {
    flex: 1;
    padding: 14px;
    overflow-y: auto;
    background: #f9fafb;
}

/* Scrollbar */
.chat-box::-webkit-scrollbar {
    width: 6px;
}
.chat-box::-webkit-scrollbar-thumb {
    background: #d1d5db;
    border-radius: 10px;
}

/* MESSAGE */
.message {
    margin-bottom: 12px;
    display: flex;
}

.bot {
    justify-content: flex-start;
}

.user {
    justify-content: flex-end;
}

/* BUBBLE */
.bubble {
    max-width: 78%;
    padding: 12px 16px;
    border-radius: 18px;
    font-size: 14px;
    line-height: 1.5;
    animation: fadeIn .2s ease;
}

.bot .bubble {
    background: #e5e7eb;
    color: #111827;
    border-bottom-left-radius: 6px;
}

.user .bubble {
    background: linear-gradient(135deg, #7c3aed, #9333ea);
    color: white;
    border-bottom-right-radius: 6px;
}

/* INPUT */
.chat-input {
    display: flex;
    padding: 12px;
    gap: 10px;
    border-top: 1px solid #e5e7eb;
    background: #ffffff;
}

.chat-input input {
    flex: 1;
    padding: 12px 14px;
    border-radius: 14px;
    border: 1px solid #d1d5db;
    outline: none;
    font-size: 14px;
}

.chat-input input:focus {
    border-color: #7c3aed;
}

/* SEND BUTTON */
.chat-input button {
    background: linear-gradient(135deg, #7c3aed, #c026d3);
    border: none;
    color: white;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform .2s ease, box-shadow .2s ease;
}

.chat-input button:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(124,58,237,.4);
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(4px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

    </style>
</head>
<body>

<!-- FLOATING CHAT -->
<div class="chat-floating">
    <div class="chat-container">

        <div class="chat-header">
            ðŸ¤– ZYM AI
        </div>

        <div class="chat-box" id="chatBox">
            <div class="message bot">
                <div class="bubble">
                    Halo! Saya <b>ZYM AI</b> ðŸ’ª<br>
                    Ada yang bisa saya bantu?
                </div>
            </div>
        </div>

        <form class="chat-input" id="chatForm">
            <input type="text" id="messageInput" placeholder="Ketik pesan..." required>
            <button type="submit">
                <i class="fas fa-paper-plane"></i>
            </button>
        </form>

    </div>
</div>

<script>
const chatForm = document.getElementById("chatForm");
const chatBox = document.getElementById("chatBox");
const messageInput = document.getElementById("messageInput");

chatForm.addEventListener("submit", function(e) {
    e.preventDefault();

    const msg = messageInput.value.trim();
    if (!msg) return;

    // tampilkan pesan user
    chatBox.innerHTML += `
        <div class="message user">
            <div class="bubble">${msg}</div>
        </div>
    `;

    messageInput.value = "";
    chatBox.scrollTop = chatBox.scrollHeight;

    fetch("/send_message", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: msg })
    })
    .then(res => res.json())
    .then(data => {
        chatBox.innerHTML += `
            <div class="message bot">
                <div class="bubble">${data.response}</div>
            </div>
        `;
        chatBox.scrollTop = chatBox.scrollHeight;
    });
});
</script>

</body>
</html>
